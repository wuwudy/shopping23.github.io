"use strict";(self["webpackChunkshopping_mall23"]=self["webpackChunkshopping_mall23"]||[]).push([[240],{7240:function(s,t,a){a.r(t),a.d(t,{default:function(){return u}});a(4114);var e=function(){var s=this,t=s._self._c;return t("div",{staticClass:"pay"},[t("van-nav-bar",{attrs:{title:"订单结算台","left-arrow":""},on:{"click-left":function(t){return s.$router.go(-1)}}}),t("div",{staticClass:"address-block"},[t("div",{staticClass:"addressB-icon"},[t("van-icon",{attrs:{name:"logistics"}})],1),s.showAddress?t("div",{staticClass:"addressB-info"},[t("span",{staticClass:"user"},[s._v(s._s(s.showAddress.name)+" "+s._s(s.showAddress.phone))]),t("br"),t("span",{staticClass:"address"},[s._v(s._s(s.showAddress.region.province)+" "+s._s(s.showAddress.region.city)+" "+s._s(s.showAddress.region.region)+" "+s._s(s.showAddress.detail))])]):s._e(),t("div",{staticClass:"addressB-arrow",on:{click:function(t){return s.$router.push(`/address?forwardUrl=${s.$route.path}`)}}},[t("van-icon",{attrs:{name:"arrow"}})],1)]),s.order.goodsList?t("div",{staticClass:"carts"},[s._l(s.order.goodsList,(function(a){return t("div",{key:a.goods_id,staticClass:"cart-item"},[t("img",{attrs:{src:a.goods_image}}),t("div",{staticClass:"cart-item-right"},[t("div",{staticClass:"pro-name text-ellipsis-2"},[s._v(" "+s._s(a.goods_name)+" ")]),t("div",{staticClass:"NumsCost"},[t("div",{staticClass:"nums"},[s._v("x"+s._s(a.total_num))]),t("div",{staticClass:"cost"},[s._v(" ￥"+s._s(a.total_num*a.goods_price_min)+" ")])])])])})),t("div",{staticClass:"cart-footer"},[s._v(" 共件商品，合计："),t("span",[s._v("￥"+s._s(s.cost))])])],2):s._e(),s.personal.balance?t("div",{staticClass:"pay-detail"},[t("div",{staticClass:"totalCost left-right BlackRed"},[t("span",[s._v("订单总金额:")]),t("span",[s._v("￥"+s._s(s.cost))])]),s._m(0),s._m(1)]):s._e(),t("div",{staticClass:"pay-style"},[t("van-radio-group",{model:{value:s.radio,callback:function(t){s.radio=t},expression:"radio"}},[t("div",{staticClass:"tag"},[s._v("支付方式")]),t("div",{staticClass:"item-block"},[t("div",{staticClass:"item"},[t("van-icon",{attrs:{name:"balance-pay"}}),s._v(" 余额支付（可用余额￥"+s._s(+s.personal.balance)+"元） ")],1),t("van-radio",{attrs:{name:"YvE","checked-color":"#ee0a24"}})],1),t("div",{staticClass:"item-block"},[t("div",{staticClass:"item"},[t("van-icon",{attrs:{name:"balance-pay"}}),s._v(" 余额支付（可用余额￥"+s._s(+s.personal.balance)+"元） ")],1),t("van-radio",{attrs:{name:"YinHang","checked-color":"#ee0a24"}})],1)])],1),t("div",{staticClass:"pay-msg"},[t("textarea",{directives:[{name:"model",rawName:"v-model",value:s.remark,expression:"remark"}],attrs:{name:"",id:"",cols:"30",rows:"10",placeholder:"选填：买家留言（50字内）"},domProps:{value:s.remark},on:{input:function(t){t.target.composing||(s.remark=t.target.value)}}})]),s.order.goodsList?t("div",{staticClass:"pay-footer"},[t("div",{staticClass:"payCost"},[s._v(" 实际付款"),t("span",[s._v("￥"+s._s(s.cost))])]),t("div",{staticClass:"payBtn",on:{click:s.submit}},[s._v("提交订单")])]):s._e()],1)},r=[function(){var s=this,t=s._self._c;return t("div",{staticClass:"discounts left-right"},[t("span",[s._v("优惠券：")]),t("span",[s._v("无优惠券可用")])])},function(){var s=this,t=s._self._c;return t("div",{staticClass:"deliveryCost left-right BlackRed"},[t("span",[s._v("配送费用")]),t("span",[s._v("+￥0.00")])])}],o=a(8591),i=a(731),n={name:"payIndex",data(){return{radio:"YinHang",showAddress:{},order:{},personal:{},remark:""}},async created(){this.setDefaultAddress(),this.getOrderList()},methods:{async setDefaultAddress(){const{data:{list:s}}=await(0,o.bv)(),t=s,{data:{defaultId:a}}=await(0,o.KL)();console.log(a),this.showAddress=t.find((s=>s.address_id===a))},async getOrderList(){let s={};if("cart"===this.mode){const t=await(0,i.Fs)(this.mode,{cartIds:this.cartsId});s=t.data}else{if("buyNow"!==this.mode)return;{const t=await(0,i.Fs)(this.mode,this.goodsInfo);s=t.data}}this.order=s.order,this.personal=s.personal,console.log("order:"),console.log(this.order),console.log("personal:"),console.log(this.personal)},async submit(){if("cart"===this.mode){const s=await(0,i.Z7)(this.mode,this.remark,{cartIds:this.cartsId});console.log("result:"),console.log(s)}else"buyNow"===this.mode&&await(0,i.Z7)(this.mode,this.remark,this.goodsInfo)}},computed:{mode(){return this.$route.query.mode},cartsId(){return this.$route.query.cartsId},goodsInfo(){return this.$route.query.goodsInfo},cost(){return this.order.goodsList.reduce(((s,t)=>s+t.goods_price_min*t.total_num),0).toFixed(2)}}},d=n,c=a(1656),l=(0,c.A)(d,e,r,!1,null,"02f8bb8b",null),u=l.exports},8591:function(s,t,a){a.d(t,{E1:function(){return c},JN:function(){return n},KL:function(){return i},Yx:function(){return o},ab:function(){return u},bv:function(){return r},nW:function(){return l},y_:function(){return d}});var e=a(5720);const r=()=>e.A.get("address/list"),o=s=>e.A.post("address/detail",{addressId:s}),i=()=>e.A.get("/address/defaultId"),n=()=>e.A.get("/region/tree"),d=s=>{e.A.post("/address/setDefault",{addressId:s})},c=s=>{e.A.post("/address/add",s)},l=s=>{e.A.post("/address/edit",s)},u=s=>{e.A.post("/address/remove",{addressId:s})}},731:function(s,t,a){a.d(t,{Fs:function(){return r},Z7:function(){return o},n7:function(){return i}});var e=a(5720);const r=(s,t)=>{const a={mode:s,delivery:0,couponId:0,isUsePoints:0,...t};return e.A.get("/checkout/order",{params:a})},o=(s,t,a)=>{const r={mode:s,delivery:0,couponId:0,isUsePoints:0,payType:10,remark:t,...a};return e.A.post("/checkout/order",r)},i=s=>{const t={dataType:s,page:1};return e.A.get("/order/list",{params:t})}}}]);
//# sourceMappingURL=240.97190bf7.js.map