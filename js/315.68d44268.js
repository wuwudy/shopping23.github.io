"use strict";(self["webpackChunkshopping_mall23"]=self["webpackChunkshopping_mall23"]||[]).push([[315],{7315:function(s,d,t){t.r(d),t.d(d,{default:function(){return u}});t(4114);var e=function(){var s=this,d=s._self._c;return d("div",{staticClass:"address"},[d("van-nav-bar",{attrs:{title:"收货地址","left-arrow":""},on:{"click-left":function(d){return s.$router.back()}}}),s.addressList?d("div",{staticClass:"address-list"},[d("van-radio-group",{model:{value:s.defaultAddressId,callback:function(d){s.defaultAddressId=d},expression:"defaultAddressId"}},s._l(s.addressList,(function(t){return d("div",{key:t.address_id,staticClass:"address-item"},[d("div",{staticClass:"user-info"},[d("span",{staticClass:"user-name"},[s._v(s._s(t.name))]),d("span",{staticClass:"user-phone"},[s._v(s._s(t.phone))])]),d("div",{staticClass:"address-info"},[d("address",[s._v(" "+s._s(t.region.province)+" "+s._s(t.region.city)+" "+s._s(t.region.region)+" "+s._s(t.detail)+" ")])]),d("div",{staticClass:"operation",attrs:{"data-id":t.address_id}},[d("span",{staticClass:"default-address"},[d("van-radio",{attrs:{name:t.address_id}},[t.address_id==s.defaultAddressId?d("span",[s._v("默认")]):d("span",[s._v("选择")])])],1),d("div",{staticClass:"edit-del"},[d("span",{staticClass:"edit-address",on:{click:function(d){return s.$router.push(`/addressEditAdd?id=${t.address_id}&defaultId=${s.defaultAddressId}`)}}},[d("van-icon",{attrs:{name:"edit"}}),s._v("编辑")],1),d("span",{staticClass:"delete-address",on:{click:function(d){return s.deleteAddress(t.address_id)}}},[d("van-icon",{attrs:{name:"delete-o"}}),s._v("删除")],1)])])])})),0)],1):s._e(),d("div",{staticClass:"address-footer"},[d("button",{staticClass:"add-address-btn",on:{click:function(d){return s.$router.push("/addressEditAdd")}}},[s._v(" 添加收货地址 ")])])],1)},a=[],r=t(8591),i={name:"addressIndex",data(){return{show:!1,addressList:[],defaultAddressId:0,firstRender:!0}},methods:{async setAddressList(){const s=await(0,r.bv)();this.addressList=s.data.list,console.log("addressList:"),console.log(this.addressList)},async setDefaultAddressId(){const s=await(0,r.KL)();this.defaultAddressId=s.data.defaultId,console.log("defaultId:"),console.log(this.defaultAddressId)},async handleAddressList(){const s=this.addressList.findIndex((s=>s.address_id===this.defaultAddressId));if(-1!==s){const d=this.addressList.splice(s,1)[0];this.addressList.unshift(d)}},async deleteAddress(s){(0,r.ab)(s),await this.setAddressList(),this.handleAddressList()}},watch:{defaultAddressId:async function(s){try{if(this.firstRender)return;await(0,r.y_)(s),console.log("inUpdate"),"/pay"===this.forwardUrl&&this.$router.go(-1),this.$toast("修改默认地址成功")}catch(d){console.dir(d),this.$toast("修改默认地址失败")}console.log(s)}},computed:{forwardUrl(){return this.$route.query.forwardUrl}},async created(){await this.setAddressList(),await this.setDefaultAddressId(),this.handleAddressList(),this.firstRender=!1,console.log(this.forwardUrl)},mounted(){console.log("mounted")},updated(){console.log("updated")}},n=i,o=t(1656),l=(0,o.A)(n,e,a,!1,null,"fd023466",null),u=l.exports},8591:function(s,d,t){t.d(d,{E1:function(){return l},JN:function(){return n},KL:function(){return i},Yx:function(){return r},ab:function(){return c},bv:function(){return a},nW:function(){return u},y_:function(){return o}});var e=t(5720);const a=()=>e.A.get("address/list"),r=s=>e.A.post("address/detail",{addressId:s}),i=()=>e.A.get("/address/defaultId"),n=()=>e.A.get("/region/tree"),o=s=>{e.A.post("/address/setDefault",{addressId:s})},l=s=>{e.A.post("/address/add",s)},u=s=>{e.A.post("/address/edit",s)},c=s=>{e.A.post("/address/remove",{addressId:s})}}}]);
//# sourceMappingURL=315.68d44268.js.map