{"version":3,"file":"js/315.68d44268.js","mappings":"sLAAIA,EAAS,WAAkB,IAAIC,EAAIC,KAAKC,EAAGF,EAAIG,MAAMD,GAAG,OAAOA,EAAG,MAAM,CAACE,YAAY,WAAW,CAACF,EAAG,cAAc,CAACG,MAAM,CAAC,MAAQ,OAAO,aAAa,IAAIC,GAAG,CAAC,aAAa,SAASC,GAAQ,OAAOP,EAAIQ,QAAQC,MAAM,KAAMT,EAAIU,YAAaR,EAAG,MAAM,CAACE,YAAY,gBAAgB,CAACF,EAAG,kBAAkB,CAACS,MAAM,CAACC,MAAOZ,EAAIa,iBAAkBC,SAAS,SAAUC,GAAMf,EAAIa,iBAAiBE,CAAG,EAAEC,WAAW,qBAAqBhB,EAAIiB,GAAIjB,EAAIU,aAAa,SAASQ,GAAM,OAAOhB,EAAG,MAAM,CAACiB,IAAID,EAAKE,WAAWhB,YAAY,gBAAgB,CAACF,EAAG,MAAM,CAACE,YAAY,aAAa,CAACF,EAAG,OAAO,CAACE,YAAY,aAAa,CAACJ,EAAIqB,GAAGrB,EAAIsB,GAAGJ,EAAKK,SAASrB,EAAG,OAAO,CAACE,YAAY,cAAc,CAACJ,EAAIqB,GAAGrB,EAAIsB,GAAGJ,EAAKM,YAAYtB,EAAG,MAAM,CAACE,YAAY,gBAAgB,CAACF,EAAG,UAAU,CAACF,EAAIqB,GAAG,IAAIrB,EAAIsB,GAAGJ,EAAKO,OAAOC,UAAU,IAAI1B,EAAIsB,GAAGJ,EAAKO,OAAOE,MAAM,IAAI3B,EAAIsB,GAAGJ,EAAKO,OAAOA,QAAQ,IAAIzB,EAAIsB,GAAGJ,EAAKU,QAAQ,SAAS1B,EAAG,MAAM,CAACE,YAAY,YAAYC,MAAM,CAAC,UAAUa,EAAKE,aAAa,CAAClB,EAAG,OAAO,CAACE,YAAY,mBAAmB,CAACF,EAAG,YAAY,CAACG,MAAM,CAAC,KAAOa,EAAKE,aAAa,CAAEF,EAAKE,YAAcpB,EAAIa,iBAAkBX,EAAG,OAAO,CAACF,EAAIqB,GAAG,QAAQnB,EAAG,OAAO,CAACF,EAAIqB,GAAG,WAAW,GAAGnB,EAAG,MAAM,CAACE,YAAY,YAAY,CAACF,EAAG,OAAO,CAACE,YAAY,eAAeE,GAAG,CAAC,MAAQ,SAASC,GAAQ,OAAOP,EAAIQ,QAAQqB,KAC9tC,sBAAqBX,EAAKE,wBAAwBpB,EAAIa,mBACxD,IAAI,CAACX,EAAG,WAAW,CAACG,MAAM,CAAC,KAAO,UAAUL,EAAIqB,GAAG,OAAO,GAAGnB,EAAG,OAAO,CAACE,YAAY,iBAAiBE,GAAG,CAAC,MAAQ,SAASC,GAAQ,OAAOP,EAAI8B,cAAcZ,EAAKE,WAAW,IAAI,CAAClB,EAAG,WAAW,CAACG,MAAM,CAAC,KAAO,cAAcL,EAAIqB,GAAG,OAAO,QAAQ,IAAG,IAAI,GAAGrB,EAAI+B,KAAK7B,EAAG,MAAM,CAACE,YAAY,kBAAkB,CAACF,EAAG,SAAS,CAACE,YAAY,kBAAkBE,GAAG,CAAC,MAAQ,SAASC,GAAQ,OAAOP,EAAIQ,QAAQqB,KAAK,kBAAkB,IAAI,CAAC7B,EAAIqB,GAAG,iBAAiB,EAC7c,EACIW,EAAkB,G,UC8DtB,GACAT,KAAA,eACAU,IAAAA,GACA,OACAC,MAAA,EACAxB,YAAA,GACAG,iBAAA,EACAsB,aAAA,EAEA,EACAC,QAAA,CACA,oBAAAC,GACA,MAAAC,QAAAC,EAAAA,EAAAA,MACA,KAAA7B,YAAA4B,EAAAL,KAAAO,KACAC,QAAAC,IAAA,gBACAD,QAAAC,IAAA,KAAAhC,YACA,EACA,yBAAAiC,GACA,MAAAL,QAAAM,EAAAA,EAAAA,MACA,KAAA/B,iBAAAyB,EAAAL,KAAAY,UACAJ,QAAAC,IAAA,cACAD,QAAAC,IAAA,KAAA7B,iBACA,EAEA,uBAAAiC,GACA,MAAAC,EAAA,KAAArC,YAAAsC,WACA9B,GAAAA,EAAAE,aAAA,KAAAP,mBAEA,QAAAkC,EAAA,CACA,MAAA7B,EAAA,KAAAR,YAAAuC,OAAAF,EAAA,MACA,KAAArC,YAAAwC,QAAAhC,EACA,CACA,EACA,mBAAAY,CAAAqB,IACArB,EAAAA,EAAAA,IAAAqB,SAEA,KAAAd,iBACA,KAAAS,mBACA,GAEAM,MAAA,CAEAvC,iBAAA,eAAAwC,GACA,IACA,QAAAlB,YAAA,aAEAmB,EAAAA,EAAAA,IAAAD,GAEAZ,QAAAC,IAAA,YAEA,cAAAa,YACA,KAAA/C,QAAAgD,IAAA,GAEA,KAAAC,OAAA,WACA,OAAAC,GACAjB,QAAAkB,IAAAD,GACA,KAAAD,OAAA,WACA,CAEAhB,QAAAC,IAAAW,EACA,GAEAO,SAAA,CACAL,UAAAA,GACA,YAAAM,OAAAC,MAAAP,UACA,GAEA,aAAAQ,SACA,KAAA1B,uBACA,KAAAM,sBAEA,KAAAG,oBAEA,KAAAX,aAAA,EACAM,QAAAC,IAAA,KAAAa,WACA,EACAS,OAAAA,GACAvB,QAAAC,IAAA,UACA,EACAuB,OAAAA,GACAxB,QAAAC,IAAA,UACA,GCnJ6P,I,UCQzPwB,GAAY,OACd,EACAnE,EACAiC,GACA,EACA,KACA,WACA,MAIF,EAAekC,EAAiB,O,8OChBzB,MAAM3B,EAAaA,IACjB4B,EAAAA,EAAQC,IAAI,gBAIRC,EAAmBC,GACvBH,EAAAA,EAAQI,KAAK,iBAAkB,CACpCD,cAKS1B,EAAiBA,IACrBuB,EAAAA,EAAQC,IAAI,sBAIRI,EAAYA,IAChBL,EAAAA,EAAQC,IAAI,gBAIRd,EAAoBgB,IAC/BH,EAAAA,EAAQI,KAAK,sBAAuB,CAClCD,aACA,EAISG,EAAaxC,IACxBkC,EAAAA,EAAQI,KAAK,eAAgBtC,EAAK,EAIvByC,EAAczC,IACzBkC,EAAAA,EAAQI,KAAK,gBAAiBtC,EAAK,EAIxBH,EAAgBwC,IAC3BH,EAAAA,EAAQI,KAAK,kBAAmB,CAAED,aAAY,C","sources":["webpack://shopping_mall23/./src/views/address/index.vue","webpack://shopping_mall23/src/views/address/index.vue","webpack://shopping_mall23/./src/views/address/index.vue?12d6","webpack://shopping_mall23/./src/views/address/index.vue?812f","webpack://shopping_mall23/./src/api/address/index.js"],"sourcesContent":["var render = function render(){var _vm=this,_c=_vm._self._c;return _c('div',{staticClass:\"address\"},[_c('van-nav-bar',{attrs:{\"title\":\"收货地址\",\"left-arrow\":\"\"},on:{\"click-left\":function($event){return _vm.$router.back()}}}),(_vm.addressList)?_c('div',{staticClass:\"address-list\"},[_c('van-radio-group',{model:{value:(_vm.defaultAddressId),callback:function ($$v) {_vm.defaultAddressId=$$v},expression:\"defaultAddressId\"}},_vm._l((_vm.addressList),function(item){return _c('div',{key:item.address_id,staticClass:\"address-item\"},[_c('div',{staticClass:\"user-info\"},[_c('span',{staticClass:\"user-name\"},[_vm._v(_vm._s(item.name))]),_c('span',{staticClass:\"user-phone\"},[_vm._v(_vm._s(item.phone))])]),_c('div',{staticClass:\"address-info\"},[_c('address',[_vm._v(\" \"+_vm._s(item.region.province)+\" \"+_vm._s(item.region.city)+\" \"+_vm._s(item.region.region)+\" \"+_vm._s(item.detail)+\" \")])]),_c('div',{staticClass:\"operation\",attrs:{\"data-id\":item.address_id}},[_c('span',{staticClass:\"default-address\"},[_c('van-radio',{attrs:{\"name\":item.address_id}},[(item.address_id == _vm.defaultAddressId)?_c('span',[_vm._v(\"默认\")]):_c('span',[_vm._v(\"选择\")])])],1),_c('div',{staticClass:\"edit-del\"},[_c('span',{staticClass:\"edit-address\",on:{\"click\":function($event){return _vm.$router.push(\n                  `/addressEditAdd?id=${item.address_id}&defaultId=${_vm.defaultAddressId}`\n                )}}},[_c('van-icon',{attrs:{\"name\":\"edit\"}}),_vm._v(\"编辑\")],1),_c('span',{staticClass:\"delete-address\",on:{\"click\":function($event){return _vm.deleteAddress(item.address_id)}}},[_c('van-icon',{attrs:{\"name\":\"delete-o\"}}),_vm._v(\"删除\")],1)])])])}),0)],1):_vm._e(),_c('div',{staticClass:\"address-footer\"},[_c('button',{staticClass:\"add-address-btn\",on:{\"click\":function($event){return _vm.$router.push('/addressEditAdd')}}},[_vm._v(\" 添加收货地址 \")])])],1)\n}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\r\n  <div class=\"address\">\r\n    <van-nav-bar\r\n      title=\"收货地址\"\r\n      left-arrow\r\n      @click-left=\"$router.back()\"\r\n    ></van-nav-bar>\r\n    <div class=\"address-list\" v-if=\"addressList\">\r\n      <van-radio-group v-model=\"defaultAddressId\">\r\n        <div\r\n          class=\"address-item\"\r\n          v-for=\"item in addressList\"\r\n          :key=\"item.address_id\"\r\n        >\r\n          <div class=\"user-info\">\r\n            <span class=\"user-name\">{{ item.name }}</span>\r\n            <span class=\"user-phone\">{{ item.phone }}</span>\r\n          </div>\r\n          <div class=\"address-info\">\r\n            <address>\r\n              {{ item.region.province }} {{ item.region.city }}\r\n              {{ item.region.region }} {{ item.detail }}\r\n            </address>\r\n          </div>\r\n          <div class=\"operation\" :data-id=\"item.address_id\">\r\n            <span class=\"default-address\">\r\n              <van-radio :name=\"item.address_id\">\r\n                <span v-if=\"item.address_id == defaultAddressId\">默认</span>\r\n                <span v-else>选择</span>\r\n              </van-radio>\r\n            </span>\r\n            <div class=\"edit-del\">\r\n              <span\r\n                class=\"edit-address\"\r\n                @click=\"\r\n                  $router.push(\r\n                    `/addressEditAdd?id=${item.address_id}&defaultId=${defaultAddressId}`\r\n                  )\r\n                \"\r\n                ><van-icon name=\"edit\" />编辑</span\r\n              >\r\n              <span\r\n                class=\"delete-address\"\r\n                @click=\"deleteAddress(item.address_id)\"\r\n                ><van-icon name=\"delete-o\" />删除</span\r\n              >\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </van-radio-group>\r\n    </div>\r\n    <div class=\"address-footer\">\r\n      <button class=\"add-address-btn\" @click=\"$router.push('/addressEditAdd')\">\r\n        添加收货地址\r\n      </button>\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport {\r\n  getAddress,\r\n  defaultAddress,\r\n  setDefaultAddress,\r\n  deleteAddress\r\n} from '@/api/address'\r\nexport default {\r\n  name: 'addressIndex',\r\n  data() {\r\n    return {\r\n      show: false,\r\n      addressList: [],\r\n      defaultAddressId: 0,\r\n      firstRender: true\r\n    }\r\n  },\r\n  methods: {\r\n    async setAddressList() {\r\n      const result = await getAddress()\r\n      this.addressList = result.data.list\r\n      console.log('addressList:')\r\n      console.log(this.addressList)\r\n    },\r\n    async setDefaultAddressId() {\r\n      const result = await defaultAddress()\r\n      this.defaultAddressId = result.data.defaultId\r\n      console.log('defaultId:')\r\n      console.log(this.defaultAddressId)\r\n    },\r\n    // 数据处理，将addressList中，地址项的address_id与defaultAddressId相同的项提前至数组开头\r\n    async handleAddressList() {\r\n      const index = this.addressList.findIndex(\r\n        item => item.address_id === this.defaultAddressId\r\n      )\r\n      if (index !== -1) {\r\n        const item = this.addressList.splice(index, 1)[0]\r\n        this.addressList.unshift(item)\r\n      }\r\n    },\r\n    async deleteAddress(id) {\r\n      deleteAddress(id)\r\n\r\n      await this.setAddressList()\r\n      this.handleAddressList()\r\n    }\r\n  },\r\n  watch: {\r\n    //监听数据defaultAddressId的变化\r\n    defaultAddressId: async function (newVal) {\r\n      try {\r\n        if (this.firstRender) return\r\n        // 发送修改默认地址请求\r\n        await setDefaultAddress(newVal)\r\n\r\n        console.log('inUpdate')\r\n        //如果是从订单结算页面pay来的，需要返回\r\n        if (this.forwardUrl === '/pay') {\r\n          this.$router.go(-1)\r\n        }\r\n        this.$toast('修改默认地址成功')\r\n      } catch (error) {\r\n        console.dir(error)\r\n        this.$toast('修改默认地址失败')\r\n      }\r\n\r\n      console.log(newVal)\r\n    }\r\n  },\r\n  computed: {\r\n    forwardUrl() {\r\n      return this.$route.query.forwardUrl\r\n    }\r\n  },\r\n  async created() {\r\n    await this.setAddressList()\r\n    await this.setDefaultAddressId()\r\n\r\n    this.handleAddressList()\r\n\r\n    this.firstRender = false\r\n    console.log(this.forwardUrl)\r\n  },\r\n  mounted() {\r\n    console.log('mounted')\r\n  },\r\n  updated() {\r\n    console.log('updated')\r\n  }\r\n}\r\n</script>\r\n\r\n<style scoped lang=\"less\">\r\n.address {\r\n  .van-nav-bar {\r\n    height: 46px;\r\n    background-color: #ffffff;\r\n  }\r\n  .address-list {\r\n    height: 550px;\r\n    background-color: #fafafa;\r\n    overflow: auto;\r\n    .address-item {\r\n      // background-color: skyblue;\r\n      margin: 10px;\r\n      padding: 15px;\r\n      height: 120px;\r\n      border-radius: 10px;\r\n      box-shadow: 0 0 5px rgba(0, 0, 0, 0.1);\r\n      font-size: 16px;\r\n      display: flex;\r\n      justify-content: space-between;\r\n      flex-direction: column;\r\n      align-items: center;\r\n      .user-info {\r\n        height: 40px;\r\n        width: 100%;\r\n        display: flex;\r\n        justify-content: flex-start;\r\n        align-items: baseline;\r\n        .user-name {\r\n          margin-right: 10px;\r\n        }\r\n      }\r\n      .address-info {\r\n        height: 40px;\r\n        width: 100%;\r\n        display: flex;\r\n        justify-content: flex-start;\r\n        align-items: baseline;\r\n        margin-bottom: 5px;\r\n        border-bottom: 1px solid #e5e5e5;\r\n        address {\r\n          font-size: 16px;\r\n          // 取消address标签的倾斜和加粗\r\n          font-style: normal;\r\n          font-weight: normal;\r\n        }\r\n      }\r\n      .operation {\r\n        height: 30px;\r\n        width: 100%;\r\n        margin-top: 5px;\r\n        display: flex;\r\n        justify-content: space-between;\r\n        align-items: baseline;\r\n        .edit-del {\r\n          display: flex;\r\n          span {\r\n            margin-left: 10px;\r\n            .van-icon {\r\n              margin-right: 5px;\r\n            }\r\n          }\r\n        }\r\n      }\r\n    }\r\n  }\r\n  .address-footer {\r\n    position: fixed;\r\n    bottom: 0;\r\n    width: 375px;\r\n    height: 50px;\r\n    background-color: #ffffff;\r\n    display: flex;\r\n    justify-content: center; /* 水平居中 */\r\n    align-items: center; /* 垂直居中 */\r\n    .add-address-btn {\r\n      width: 80%;\r\n      height: 80%;\r\n      background-color: #ff4444;\r\n      color: #ffffff;\r\n      border: none;\r\n      border-radius: 20px;\r\n      font-size: 16px;\r\n    }\r\n  }\r\n}\r\n</style>\r\n","import mod from \"-!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js??clonedRuleSet-40.use[1]!../../../node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./index.vue?vue&type=script&lang=js\"; export default mod; export * from \"-!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js??clonedRuleSet-40.use[1]!../../../node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./index.vue?vue&type=script&lang=js\"","import { render, staticRenderFns } from \"./index.vue?vue&type=template&id=fd023466&scoped=true\"\nimport script from \"./index.vue?vue&type=script&lang=js\"\nexport * from \"./index.vue?vue&type=script&lang=js\"\nimport style0 from \"./index.vue?vue&type=style&index=0&id=fd023466&prod&scoped=true&lang=less\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/@vue/vue-loader-v15/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"fd023466\",\n  null\n  \n)\n\nexport default component.exports","import request from '@/utils/request'\r\n\r\n//获取收货地址\r\nexport const getAddress = () => {\r\n  return request.get('address/list')\r\n}\r\n\r\n//获取详细收货地址\r\nexport const getAddressDetail = addressId => {\r\n  return request.post('address/detail', {\r\n    addressId\r\n  })\r\n}\r\n\r\n//默认收货地址id\r\nexport const defaultAddress = () => {\r\n  return request.get('/address/defaultId')\r\n}\r\n\r\n//获取省市区\r\nexport const getRegion = () => {\r\n  return request.get('/region/tree')\r\n}\r\n\r\n//设置默认收货地址\r\nexport const setDefaultAddress = addressId => {\r\n  request.post('/address/setDefault', {\r\n    addressId\r\n  })\r\n}\r\n\r\n//添加收货地址\r\nexport const addAddress = data => {\r\n  request.post('/address/add', data)\r\n}\r\n\r\n//编辑收货地址\r\nexport const editAddress = data => {\r\n  request.post('/address/edit', data)\r\n}\r\n\r\n//删除收货地址\r\nexport const deleteAddress = addressId => {\r\n  request.post('/address/remove', { addressId })\r\n}\r\n"],"names":["render","_vm","this","_c","_self","staticClass","attrs","on","$event","$router","back","addressList","model","value","defaultAddressId","callback","$$v","expression","_l","item","key","address_id","_v","_s","name","phone","region","province","city","detail","push","deleteAddress","_e","staticRenderFns","data","show","firstRender","methods","setAddressList","result","getAddress","list","console","log","setDefaultAddressId","defaultAddress","defaultId","handleAddressList","index","findIndex","splice","unshift","id","watch","newVal","setDefaultAddress","forwardUrl","go","$toast","error","dir","computed","$route","query","created","mounted","updated","component","request","get","getAddressDetail","addressId","post","getRegion","addAddress","editAddress"],"sourceRoot":""}