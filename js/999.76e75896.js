"use strict";(self["webpackChunkshopping_mall23"]=self["webpackChunkshopping_mall23"]||[]).push([[999],{9999:function(e,t,s){s.r(t),s.d(t,{default:function(){return c}});var n=function(){var e=this,t=e._self._c;return t("div",{staticClass:"edit_add"},[t("van-nav-bar",{attrs:{title:"添加收货地址","left-arrow":""},on:{"click-left":function(t){return e.$router.back()}}}),t("van-address-edit",{staticClass:"myEdit",attrs:{"address-info":e.addressDetail,"area-list":e.vantRegion,"show-set-default":!(e.addressId===e.defaultAddressId),"area-value":"110000","area-placeholder":e.addressId?[e.addressDetail.province,e.addressDetail.city,e.addressDetail.county].join("/"):"选择省/市/区","area-columns-placeholder":["请选择","请选择","请选择"],"save-button-text":e.addressId?"修改":"添加"},on:{save:e.onSave,"change-area":e.onChangeArea}})],1)},i=[],d=(s(4114),s(8591)),a={name:"editAndAdd",data(){return{addressDetail:{},region:{},vantRegion:{},regionId:0}},methods:{async setRegion(){const e=await(0,d.JN)();this.region=e.data.list,console.log("region:"),console.log(this.region),this.handleregion()},handleregion(){const e={province_list:{},city_list:{},county_list:{}};let t=1e5;for(let s in this.region){const n=this.region[s];e.province_list[t]=n.name;let i=t+100;for(let t in n.city){const s=n.city[t];e.city_list[i]=s.name;let d=i+1;for(let t in s.region){const n=s.region[t];e.county_list[d]=n.name,d+=1}i+=100}t+=1e4}console.log(e),this.vantRegion=e},IdToVantId(e,t,s){let n=0;for(let a in this.region){if(a===e.toString())break;n++}let i=0;for(let a in this.region[e.toString()].city){if(a===t.toString())break;i++}console.log("city_id - province_id"+(t-e));let d=1e5+1e4*n+100*(i+1)+(s-t);return console.log("result"+d),d.toString()},VantIdtoId(e,t,s){let n=[];for(let i in this.region)if(this.region[i].name===e){n[0]={value:1*i,lavel:e};const d=this.region[i].city;for(let e in d)if(d[e].name===t){n[1]={value:1*e,lavel:t};const i=d[e].region;for(let e in i)if(i[e].name===s)return n[2]={value:1*e,lavel:s},n}}},async setAddressForm(){const{data:e}=await(0,d.Yx)(this.addressId);console.log(e);const t=e.detail,s={};s.id=this.addressId,s.name=t.name,s.tel=t.phone,s.province=t.region.province,s.city=t.region.city,s.county=t.region.region,s.addressDetail=t.detail,s.isDefault=this.addressId===this.defaultAddressId;const n=this.IdToVantId(t.province_id,t.city_id,t.region_id);console.log("cal_area_id:"+n),s.areaCode=n,this.addressDetail=s,this.regionId=t.region_id,console.log(this.addressDetail)},async onSave(e){console.log(e);const t=this.VantIdtoId(e.province,e.city,e.county);console.log("regionArray"),console.log(t);const s={form:{name:e.name,phone:e.tel,region:t,detail:e.addressDetail}};try{if(this.addressId?(s.addressId=this.addressId,await(0,d.nW)(s)):await(0,d.E1)(s),e.isDefault)if(this.addressId)!this.addressId===this.defaultAddressId&&(0,d.y_)(this.addressId);else{const t=await(0,d.bv)().data.list,s=t.find((t=>t.detail===e.addressDetail)).address_id;(0,d.y_)(s)}}catch(n){console.dir(n)}this.$router.push("/address")},onChangeDetail(){},onChangeArea(e){console.log(e)}},computed:{addressId(){return this.$route.query.id},defaultAddressId(){return this.$route.query.defaultId}},async created(){await this.setRegion(),this.addressId&&await this.setAddressForm()},mounted(){}},r=a,o=s(1656),l=(0,o.A)(r,n,i,!1,null,"7dd69160",null),c=l.exports},8591:function(e,t,s){s.d(t,{E1:function(){return l},JN:function(){return r},KL:function(){return a},Yx:function(){return d},ab:function(){return u},bv:function(){return i},nW:function(){return c},y_:function(){return o}});var n=s(5720);const i=()=>n.A.get("address/list"),d=e=>n.A.post("address/detail",{addressId:e}),a=()=>n.A.get("/address/defaultId"),r=()=>n.A.get("/region/tree"),o=e=>{n.A.post("/address/setDefault",{addressId:e})},l=e=>{n.A.post("/address/add",e)},c=e=>{n.A.post("/address/edit",e)},u=e=>{n.A.post("/address/remove",{addressId:e})}}}]);
//# sourceMappingURL=999.76e75896.js.map